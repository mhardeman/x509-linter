package atis1000080_test

import (
	"encoding/base64"
	"fmt"

	"github.com/zmap/zcrypto/x509"
)

func checkParseCertError(err error) {
	if err != nil {
		panic(fmt.Sprintf("cannot parse the certificate, error: %s", err.Error()))
	}
}

// parseCert parses Base64 encoded X509 certificate
func ParseCert(enc string) *x509.Certificate {
	raw, err := base64.StdEncoding.DecodeString(enc)
	checkParseCertError(err)

	cert, err := x509.ParseCertificate(raw)
	checkParseCertError(err)

	return cert
}

var (
	TEST_CERT_CORRECT                      *x509.Certificate
	TEST_CERT_VERSION_INCORRECT            *x509.Certificate
	TEST_CERT_SIG_ALG_INCORRECT            *x509.Certificate
	TEST_CERT_BASIC_CONSTRAINTS_UNCRITICAL *x509.Certificate
	TEST_CERT_SHAKEN_POLICY_ABSENT         *x509.Certificate
	TEST_CERT_SHAKEN_POLICY_NOT_SINGLE     *x509.Certificate
	TEST_CERT_SHAKEN_POLICY_v1_1           *x509.Certificate
	TEST_CERT_CRL_MULTIPLE                 *x509.Certificate
	TEST_CERT_CRL_REACHABLE                *x509.Certificate
	TEST_CERT_KEY_USAGE_UNCRITICAL         *x509.Certificate
	TEST_CERT_KEY_USAGE_MULTIPLE_FLAGS     *x509.Certificate
	TEST_CERT_SUBJECT_KEY_INCORRECT_CURVE  *x509.Certificate
	TEST_CERT_SUBJECT_KEY_INCORRECT_ALG    *x509.Certificate
	TEST_CERT_TN_ENTRY_MULTIPLE            *x509.Certificate
	TEST_CERT_TN_ENTRY_ZERO_LEN            *x509.Certificate
	TEST_CERT_SUBJECT_SERIALNUMBER         *x509.Certificate
	TEST_CERT_SUBJECT_SERIALNUMBER_ODD     *x509.Certificate
	TEST_CERT_AMBIGUOUS                    *x509.Certificate
)

func init() {
	TEST_CERT_CORRECT = ParseCert("MIIDADCCAqagAwIBAgIQU9c1dztZF+wkcab3vvy13DAKBggqhkjOPQQDAjBnMQswCQYDVQQGEwJVUzEZMBcGA1UEChMQVHJhbnNOZXh1cywgSW5jLjEPMA0GA1UECxMGU0hBS0VOMSwwKgYDVQQDEyNUcmFuc05leHVzLCBJbmMuIFNIQUtFTiBJc3N1aW5nIENBMzAeFw0yMjA2MzAwNDI2MTZaFw0yMjEwMDMwNDI2MTVaMF0xCzAJBgNVBAYTAlVTMScwJQYDVQQKEx5Mb3cgTGF0ZW5jeSBDb21tdW5pY2F0aW9ucyBMTEMxDzANBgNVBAsTBlNIQUtFTjEUMBIGA1UEAxMLU0hBS0VOIDcwOUowWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAAS64O/6oW1u+rqGG1QzbaIV8+T8n77zktdefHFM6nomucy4sXzUipul9z2dqSBpKf4MztG2aTH9B8OQDbSna8CRo4IBPDCCATgwDAYDVR0TAQH/BAIwADAOBgNVHQ8BAf8EBAMCAIAwHQYDVR0OBBYEFOJMfrlWj84knnyieRqxlAeasLQcMB8GA1UdIwQYMBaAFLuW3jESzdOWmYSkNjBgPNdSgX0nMBcGA1UdIAQQMA4wDAYKYIZIAYb/CQEBAzCBpgYDVR0fBIGeMIGbMIGYoDqgOIY2aHR0cHM6Ly9hdXRoZW50aWNhdGUtYXBpLmljb25lY3Rpdi5jb20vZG93bmxvYWQvdjEvY3JsolqkWDBWMRQwEgYDVQQHDAtCcmlkZ2V3YXRlcjELMAkGA1UECAwCTkoxEzARBgNVBAMMClNUSS1QQSBDUkwxCzAJBgNVBAYTAlVTMQ8wDQYDVQQKDAZTVEktUEEwFgYIKwYBBQUHARoECjAIoAYWBDcwOUowCgYIKoZIzj0EAwIDSAAwRQIgPhdUuEGIF06HIUE+TmZktuQQCRALo6DDkOuozbYi0kwCIQCmoOiKwxcSlLMt+wmqt9vdwbwfmqiYhHwBsy/ZbxQWzg==")
	TEST_CERT_VERSION_INCORRECT = ParseCert("MIHvMIGXoAMCAQECAQEwCgYIKoZIzj0EAwIwADAeFw0yMjA5MTYwODU5MzJaFw0yMjA5MTcwODU5MzJaMAAwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAARx8/OpkbEm544PA31d9rD3np+IB5q3E0kuAnQtsGVd7nNkQjH/SBI7XrurHwI/81horaSU4M+zqvVRAMpOQ/9qowIwADAKBggqhkjOPQQDAgNHADBEAiBiKbdeF7g3HIx8XxFbBuVCWY4XHHkkEpjcNcVaE7A1PwIgSiBq9K2ixFnOJFqKEsWLekwBzaRAZsCc6INjHOYa1bQ=")
	TEST_CERT_SIG_ALG_INCORRECT = ParseCert("MIHvMIGXoAMCAQECAQEwCgYIKoZIzj0EAwMwADAeFw0yMjA5MTYwOTM3MTZaFw0yMjA5MTcwOTM3MTZaMAAwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAARO6dodG9C32Iua6Wj5PcH6hXTZ1Yqo1NoZNnZgRYDLt3seeFJoOdWPW8bTkhOD1UbGiQ8m79MWqHy3xplIxs08owIwADAKBggqhkjOPQQDAwNHADBEAiAHPh1D3vFTuI+SsDIp3sGqbzTpilalW/SNP5+bofzZwgIgD7TPgK9KK2BpTkbK6uNEmuBJQS/STw54DBhRI0UawoY=")
	TEST_CERT_BASIC_CONSTRAINTS_UNCRITICAL = ParseCert("MIH7MIGioAMCAQECAQEwCgYIKoZIzj0EAwMwADAeFw0yMjA5MjAxMDUyMDZaFw0yMjA5MjExMDUyMDZaMAAwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAAQz/UKsMvkObXJSY4psbNyktDXcGrdsGHOfJ9DwN8n04VjvG6jNQdCchssS6355n+7SYr1UNZ03FhYBXmsqUixRow0wCzAJBgNVHRMEAjAAMAoGCCqGSM49BAMDA0gAMEUCIF08+KrT37etQnn7Z6z6+wd1gnpgnQQ0Ga6m1bMv1LdWAiEAr3OLipF7PHSa4xZvjIE0E3p7PpkoXiWzmcFlaCi2yj8=")
	TEST_CERT_SHAKEN_POLICY_ABSENT = ParseCert("MIIBAzCBqqADAgEBAgEBMAoGCCqGSM49BAMDMAAwHhcNMjIwOTIwMTEwNDQ4WhcNMjIwOTIxMTEwNDQ4WjAAMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE6S1wjD9HJkoCPrQAHhNr92VmIcgP1seYm/oo2bVeGngNfyxmJAt3Ip2oIQJBo0m0wppaZwGliGfpBWcpAugcqqMVMBMwEQYDVR0gBAowCDAGBgQqAwQFMAoGCCqGSM49BAMDA0gAMEUCIQCoC94VExNnqD2DewzzXa+adeb4A2RnTc1mXkNjP99vPAIgBEJlzrnwKDytiDT0LWxHKIvPKeofMJehfiL0oA5pqIo=")
	TEST_CERT_SHAKEN_POLICY_NOT_SINGLE = ParseCert("MIIBEjCBuKADAgEBAgEBMAoGCCqGSM49BAMDMAAwHhcNMjIwOTIwMTEwNjA3WhcNMjIwOTIxMTEwNjA3WjAAMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEMBe+RHOYf7otlIkFSZbTJd8NqSlUKpEIF3Jm80Q8BUWBFbDvxGEpZ3Fc5Zxkw+yYDWjwmcMzLBH8EJpTYUpE6KMjMCEwHwYDVR0gBBgwFjAMBgpghkgBhv8JAQEDMAYGBCoDBAUwCgYIKoZIzj0EAwMDSQAwRgIhAOZ9Ft5JW1qukdrroplq+yGrcR3Gg66DnFvZ0V4E9YViAiEAuTawhTeXa7D0rzLzoTpISdf4sEvrF1EPAdbzA5XzDmE=")
	TEST_CERT_SHAKEN_POLICY_v1_1 = ParseCert("MIIBCTCBsKADAgEBAgEBMAoGCCqGSM49BAMCMAAwHhcNMjIwOTIwMTIzNzMxWhcNMjIwOTIxMTIzNzMxWjAAMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE+j602Xn2Z6YMx4fn6uaPDcT4btta6Yj8Oo+agwGkQ9IzAdsZry7G0ybWrq537XZMU+6yD+WUJ8LDpWBpOxqhM6MbMBkwFwYDVR0gBBAwDjAMBgpghkgBhv8JAQEBMAoGCCqGSM49BAMCA0gAMEUCIQCYYWiny6mUsvnGmYKSOD8B8vA5DGMMP3tODsdyD9mwzwIgawEWAtIANxVjFv4TavDHzCZotUR2BjkEqjcwA0h/O8k=")
	TEST_CERT_CRL_MULTIPLE = ParseCert("MIIBUjCB+aADAgEBAgEBMAoGCCqGSM49BAMDMAAwHhcNMjIwOTIwMTExNzUyWhcNMjIwOTIxMTExNzUyWjAAMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEQ+p6GxO0/mu5w7Y7ltmAgM946Xb1kHxsIIhZAZZxwhwnVv9MEWe2jhUKAPhmxNkpZEsoofvKFKy46E547/2y5qNkMGIwYAYDVR0fBFkwVzBVoFOgUYY2aHR0cHM6Ly9hdXRoZW50aWNhdGUtYXBpLmljb25lY3Rpdi5jb20vZG93bmxvYWQvdjEvY3JshhdodHRwOi8veDEuYy5sZW5jci5vcmcvMDAKBggqhkjOPQQDAwNIADBFAiEA6CWzs91fDqADFGbKYkl2DNLL45N6NiPVSwqJ2OAZwUcCIBo1CDSXwxuO7Mt7QMiM6wGWYLUqXCkrRNsZr8+QF5Rn")
	TEST_CERT_CRL_REACHABLE = ParseCert("MIIBGzCBwaADAgEBAgEBMAoGCCqGSM49BAMDMAAwHhcNMjIwOTIwMTEyMDE0WhcNMjIwOTIxMTEyMDE0WjAAMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE2pVBhVj8yRQB1LXGcdhzEBmsoxcF3ftAcwy7HImxAfo59LIu7wytYGXPO1OV9WXq1oxB62DdySNd/A0TUbB9zaMsMCowKAYDVR0fBCEwHzAdoBugGYYXaHR0cDovL3gxLmMubGVuY3Iub3JnLzAwCgYIKoZIzj0EAwMDSQAwRgIhAKEWPHFSxeu5jRd+vcYRTHVq884D7Zu6ANLik6bzTOWNAiEAmcPb4UHyl3gor8SuuYCJAlmGtbC9H96C8sR4BVL0Ctg=")
	TEST_CERT_KEY_USAGE_UNCRITICAL = ParseCert("MIH9MIGkoAMCAQECAQEwCgYIKoZIzj0EAwMwADAeFw0yMjA5MjAxMTI2MjhaFw0yMjA5MjExMTI2MjhaMAAwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAASfZw9l9Sk0H/3HwqLEVEfFOB4Vg76N0vwf4PYGmXr33xPxU1c8Ur9ozdK8Hn/7f7XZ/Kzi29FdhFicfNmEspXlow8wDTALBgNVHQ8EBAMCB4AwCgYIKoZIzj0EAwMDSAAwRQIgKuUx5NUvDRY2a1NfcLAdd7vXxNkoxqVuwmk68KMMjegCIQD61rc1RpwBniA05HL4pl9eWQXK5Hm3L/eVhxMF9QKl/w==")
	TEST_CERT_KEY_USAGE_MULTIPLE_FLAGS = ParseCert("MIH/MIGnoAMCAQECAQEwCgYIKoZIzj0EAwMwADAeFw0yMjA5MjAxMTI4MjFaFw0yMjA5MjExMTI4MjFaMAAwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAARSkkZh8Gx/Thq5tyqlrTtXh1sViQid6XMA2lhRZn1lsovO853FoegF5LS9EFMpQWq/j41YeQYvGN+6K5tOCRgEoxIwEDAOBgNVHQ8BAf8EBAMCBJAwCgYIKoZIzj0EAwMDRwAwRAIgCrIao6HlU2O5XmzFCxwsWlV5nB8JKOapMqZmbos8y7cCIF694ZJebRHiqMR+4epv8YpV+G1FQ4EJfjx1RZjrFsV6")
	TEST_CERT_SUBJECT_KEY_INCORRECT_CURVE = ParseCert("MIIBLDCBtKADAgEBAgEBMAoGCCqGSM49BAMCMAAwHhcNMjIwOTIwMTEzNDE2WhcNMjIwOTIxMTEzNDE2WjAAMHYwEAYHKoZIzj0CAQYFK4EEACIDYgAE1nT9ltQ4XDGQLSnn6z1vdSa3KIsPTun3bFFrPFJyAL+UrBUJoG/lP/HN78z/l97h2nwSerhSl7ZvRZrL+k1genhm3XhTLnhNgzhmARdDe71vS5iFHi6RkFBZtN0Tsv1LowIwADAKBggqhkjOPQQDAgNnADBkAjBr1coizcAiTy/r0Fuw85C0g14flKdGktrn+p+Ir/mA4juSxV0Q0Mn7Nieztfjhp30CMGI2V5aDlu1jiapGInxfxMgFOML1lJDd0AmH7OhVmMJRXuCnaZ1EOGSwh7tAUO6ooQ==")
	TEST_CERT_SUBJECT_KEY_INCORRECT_ALG = ParseCert("MIICfTCCAWWgAwIBAQIBATANBgkqhkiG9w0BAQsFADAAMB4XDTIyMDkyMDExMzU1OFoXDTIyMDkyMTExMzU1OFowADCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAJ58OJtEK9AvuHPt+iQjYD2DJO+Yc24YYEUOVjn13wshsVeuOJQNC4xOrEuNOhCWxAbAoWUcmOuwxjN9fPMu05izO/Pv5Y6Ny/Y7uXeSfBG7OZd6HPFRqR2bU0bodoDl6te/p+KYKoJSGtua8G8h1hQPsYfLfXYsp42uh3ikycphPLay0If9NxFv3F/k/SNX7e5gFy6hXshbVvCLfveiyXO62u9mnfZ3IAX33rW3ldV8YwAXS2v5+jskwF26IPLaNUQLCSAox2rSuKgi5b9QcLKo/tltJ4Vit/g8zoAFqxp36ynXcXyCFVi7C359jAkKEmEoziX6+7uhODIMiIzi/ksCAwEAAaMCMAAwDQYJKoZIhvcNAQELBQADggEBAJfPyoqWx54ZfoRQwm2gH59rb381EJgGiJgUyq1eClHw4xkKOHzBgQ5lpoL7ce4XdeXtqvuM1dOt7q/4TcC4YuHM0MbQnO4mgWbpydqbW9SNLvA24eSFMxnVkLjsyCY1cAuCcUKTGLnwtKu/NrB6FQ6DgSw0k93JuY+AHRBA+bfyFGs3zqY7L1ro3AAGJaJNZ2Xv3IBV0vdx1vU8Kgp/YehW3Sg1qUs0MYmt0xrXakF95dpyd9wfRf/LYymdCPaG/ffcd11YRulqrsg0F/fP6X5SvBvpbMRQ6xx+h2Zd2BPH/VBuVI/9fg34Tsg0IyNT0Kz8o3hzWTf1HDDBoSV5HDM=")
	TEST_CERT_TN_ENTRY_MULTIPLE = ParseCert("MIIBEDCBt6ADAgEBAgEBMAoGCCqGSM49BAMCMAAwHhcNMjIwOTIwMTIwMTQ2WhcNMjIwOTIxMTIwMTQ2WjAAMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEIhHDYzTD9f4daKWh+wC1Czdfc8E8xgQLD3f40XmnZm5+A/532xUUkeGdQu7BQxeuVBx0rlknGc/Z9H9tRlJ0xKMiMCAwHgYIKwYBBQUHARoEEjAQoAYWBDcwOUqgBhYENzA5SjAKBggqhkjOPQQDAgNIADBFAiB0FgnwHIRPQS4OhvKFJdAhvP2oWc2ihjawL2KTSdaruwIhAJrjnMvsrSkZzX5CrHQd2JI7H7XSquI/oTp+4GywcrDE")
	TEST_CERT_TN_ENTRY_ZERO_LEN = ParseCert("MIIBBDCBq6ADAgEBAgEBMAoGCCqGSM49BAMCMAAwHhcNMjIwOTIwMTIwNDE5WhcNMjIwOTIxMTIwNDE5WjAAMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEI3LckiWtZ06wzQXZz7GrJ2oEGVcBSrLiErAZt6DcS4eW/FNUbzT+ZDgDvgV0mJFgUqefW6LFQasI33Qdr/kfg6MWMBQwEgYIKwYBBQUHARoEBjAEoAIWADAKBggqhkjOPQQDAgNIADBFAiEAvIywplPg86yPt3gTD+zEwWy0lLHFyZvq5tNxTo5PU8ICIBt11E2xDeRaCoVUTHAKL8kDOc7J2p4W38+x8QUU6Z7H")
	TEST_CERT_SUBJECT_SERIALNUMBER = ParseCert("MIIBQjCB6aADAgEBAgEBMAoGCCqGSM49BAMCMCkxEjAQBgNVBAMTCVNvbWUgbmFtZTETMBEGA1UEBRMKMTIzNDU2Nzg5MDAeFw0yMjA5MjAxNzM2MjNaFw0yMjA5MjExNzM2MjNaMCkxEjAQBgNVBAMTCVNvbWUgbmFtZTETMBEGA1UEBRMKMTIzNDU2Nzg5MDBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABMEWxnLQroqzQhPknTRPEQxm1BTNiyTEvTp+3SZCkP984HXvVv8PHLOLWJL+fMBjmBnsmJvk8vdy4u4RM2/YfqmjAjAAMAoGCCqGSM49BAMCA0gAMEUCIBBrM+AaYmfLH+i/nf4UnodXDqHMOY/rNuw5ge1i3dq0AiEA9jjYn/vFehuavuOKfmpmv7Y/gLjQTVzEkDPGZZm2u5k=")
	TEST_CERT_SUBJECT_SERIALNUMBER_ODD = ParseCert("MIIBbDCCAROgAwIBAgIBATAKBggqhkjOPQQDAjA+MRIwEAYDVQQDEwlTb21lIG5hbWUxEzARBgNVBAUTCjEyMzQ1Njc4OTAxEzARBgNVBAUTCjEyMzQ1Njc4OTAwHhcNMjIwOTIwMTc0MTMxWhcNMjIwOTIxMTc0MTMxWjA+MRIwEAYDVQQDEwlTb21lIG5hbWUxEzARBgNVBAUTCjEyMzQ1Njc4OTAxEzARBgNVBAUTCjEyMzQ1Njc4OTAwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAASIFq+ezZ9F9sb9b1u79MiPW0xpGN0HedzGcYNaMTNb18RVQEtUDmL8T3wMkvIDDqEH/1E5SsYLm632Z/7ow1mgowIwADAKBggqhkjOPQQDAgNHADBEAiBCfkwm1QGj6Frj5jse+FI6k6TjYDnPf/kxR2tGEHxbUgIgAOLZ/d5IUcy/1EEmsunuChiD2oiCbQrZXlHSHkV/C8w=")
	TEST_CERT_AMBIGUOUS = ParseCert("MIIBPTCB5aADAgECAgEBMAoGCCqGSM49BAMCMBsxGTAXBgNVBAMTEFNvbWUgU0hBS0VOIDY2MjgwHhcNMjIwOTIwMTg1MjI1WhcNMjIwOTIxMTg1MjI1WjAbMRkwFwYDVQQDExBTb21lIFNIQUtFTiA2NjI4MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEXGF7mP7fEg2iPczsJVqZSEc3FnznTgvR2GuukwHp7eN4cgsjBKEynWoVSD1Gl2UsM5bwILxWE1i6u5oElP5eE6MaMBgwFgYIKwYBBQUHARoECjAIoAYWBDY2MjgwCgYIKoZIzj0EAwIDRwAwRAIgMs7+AuqK8nzI8VAa10zsR0AnXgR+RynBNb8Fy1u1mTQCIHUcOjo38T3PoIMLHFDEMrn9v0I+DAwAYFodTeOiHnIP")
}
